webpackJsonp([10],{A49J:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t("woOf"),s=t.n(o),a=t("Dd8w"),l=t.n(a),u=t("mvHQ"),i=t.n(u),n=t("NYxO"),c=t("Nv8u"),m={name:"",data:function(){var e=this;return{isNotFactory:"",ruleForm:{username:"",userId:"",role:"",factory:""},rules:{factory:[{validator:function(r,t,o){e.isNotFactory?o():""===t?o(new Error("This field is required")):o()},trigger:"blur"}]},roleList:[]}},methods:{submitForm:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var t={userInfo:{id:r.ruleForm.userId,userFactory:r.ruleForm.factory},roleId:r.ruleForm.role},o=i()(t);c.ConfigUserRole.r(o).then(function(e){"SUCCESS"===e.data.success?(r.$message.success("修改成功"),r.$router.push("/manager?currentPage="+r.$route.query.currentPage+"&search="+r.$route.query.search)):r.$message.error("未修改成功")}).catch(function(e){console.log(e),r.$message.error("服务器错误")})})},resetForm:function(e){this.$refs[e].resetFields()},back:function(){this.$router.push("/manager?currentPage="+this.$route.query.currentPage+"&search="+this.$route.query.search)},roleChange:function(e){for(var r=0;r<this.roleList.length;r++)this.roleList[r].id===e&&(this.roleList[r].roleFactory?this.isNotFactory=!1:(this.isNotFactory=!0,this.ruleForm.factory=""))}},computed:l()({},Object(n.c)(["currentConfig"])),created:function(){var e=this;this.size=window.innerWidth<767?"mini":"medium",this.ruleForm=s()({},this.currentConfig),console.log(this.$route.query.userId),c.GetRoleList.r().then(function(r){var t=r.data;"SUCCESS"===t.success&&(e.roleList=t.data)}).catch(function(r){console.log(r),e.$message.error("加载失败，请刷新")}),c.GetUserInfo.r(this.$route.query.userId).then(function(r){var t=r.data;e.ruleForm.username=t.data.userInfo.userName,e.ruleForm.userId=t.data.userInfo.id,e.ruleForm.role=t.data.roleInfos[0].id,t.data.roleInfos[0].roleFactory?(e.isNotFactory=!1,e.ruleForm.factory=t.data.userInfo.userFactory):(e.isNotFactory=!0,e.ruleForm.factory="")}).catch(function(r){console.log(r),e.$message.error("加载失败，请刷新")})}},f={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"config"},[t("el-card",{staticClass:"config-wrapper"},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",{staticClass:"text"},[e._v("用户角色配置")]),e._v(" "),t("el-button",{staticClass:"back",staticStyle:{float:"right"},attrs:{type:"danger"},on:{click:e.back}},[e._v("返回")])],1),e._v(" "),t("el-form",{ref:"ruleForm",staticClass:"rule-form",attrs:{model:e.ruleForm,size:e.size,rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"username"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.username,callback:function(r){e.$set(e.ruleForm,"username",r)},expression:"ruleForm.username"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户id",prop:"userId"}},[t("el-input",{attrs:{disabled:!0},model:{value:e.ruleForm.userId,callback:function(r){e.$set(e.ruleForm,"userId",r)},expression:"ruleForm.userId"}})],1),e._v(" "),t("el-form-item",{attrs:{label:"用户角色",prop:"role"}},[t("el-select",{staticStyle:{width:"100%"},on:{change:e.roleChange},model:{value:e.ruleForm.role,callback:function(r){e.$set(e.ruleForm,"role",r)},expression:"ruleForm.role"}},e._l(e.roleList,function(e){return t("el-option",{key:e.index,attrs:{label:e.roleName,value:e.id}})}))],1),e._v(" "),t("el-form-item",{attrs:{label:"用户分厂",prop:"factory"}},[t("el-input",{attrs:{disabled:e.isNotFactory},model:{value:e.ruleForm.factory,callback:function(r){e.$set(e.ruleForm,"factory",r)},expression:"ruleForm.factory"}})],1)],1),e._v(" "),t("el-button",{attrs:{type:"primary"},on:{click:function(r){e.submitForm("ruleForm")}}},[e._v("提交")]),e._v(" "),t("el-button",{on:{click:function(r){e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1)},staticRenderFns:[]};var d=t("VU/8")(m,f,!1,function(e){t("Aast")},"data-v-2830f758",null);r.default=d.exports},Aast:function(e,r){}});
//# sourceMappingURL=10.c695f0f577945509cde8.js.map