webpackJsonp([2],{"3tlU":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Dd8w"),s=a.n(r),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("transition",{attrs:{name:"fade"}},[e("div",{staticClass:"img-view",on:{click:this.bigImg}},[e("div",{staticClass:"img-layer"}),this._v(" "),e("div",{staticClass:"img"},[e("img",{attrs:{src:this.imgSrc}})])])])},staticRenderFns:[]};var l=a("VU/8")({name:"",props:["imgSrc"],methods:{bigImg:function(){this.$emit("clickit")}}},o,!1,function(t){a("yjWW")},"data-v-e4ed796a",null).exports,i=a("PJh5"),c=a.n(i),m=a("gyMJ"),n=a("LOkV"),h=a("NYxO"),p={mixins:[{data:function(){return{api:m}}}],name:"store",data:function(){return{token:"",showImg:!1,imgSrc:"",currentPage:1,pageSize:10,storeDataLength:"",sizesmall:!1,size:"medium",searchForm:{templateId:"",templateAreas:"",templateFactory:"",templateStore:""},storeData:[]}},methods:s()({},Object(h.d)({setTemplateId:"SET_TEMPLATE_ID",setTemplateAmount:"SET_TEMPLATE_AMOUNT"}),{_getFormList:function(){var t=this,e=""!==this.factory?this.factory:this.searchForm.templateFactory,a={templateId:this.searchForm.templateId,templateAreas:this.searchForm.templateAreas,templateFactory:e,templateStore:this.searchForm.templateStore};m.GetSearchStoreList.r(a).then(function(e){var a=e.data;t.storeData=a.templateStockList,t.storeDataLength=a.totalCount})},handleEdit:function(t,e){var a=e.templateStock.id,r=e.templateStock.templateAmount;this.setTemplateId(a),this.setTemplateAmount(r);var s=""!==this.factory?this.factory:this.searchForm.templateFactory;this.$router.push("/handle?id="+a+"&tid="+this.searchForm.templateId+"&areas="+this.searchForm.templateAreas+"&factory="+s+"&store="+this.searchForm.templateStore+"&currentPage="+this.currentPage)},handleDelete:function(t,e){var a=this;this.$confirm("确认删除？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info",center:!0}).then(function(){m.DeleteStock.r(e.templateStock.id).then(function(t){if("SUCCESS"===t.data.success){a.$message.success("成功删除库存");var e=""!==a.factory?a.factory:a.searchForm.templateFactory,r={templateId:a.searchForm.templateId,templateAreas:a.searchForm.templateAreas,templateFactory:e,templateStore:a.searchForm.templateStore};m.GetSearchStoreList.r(r,a.currentPage).then(function(t){var r=t.data;a.$router.push("/store?id="+a.searchForm.templateId+"&areas="+a.searchForm.templateAreas+"&factory="+e+"&store="+a.searchForm.templateStore+"&currentPage=1"),a.storeData=r.templateStockList,a.storeDataLength=parseInt(r.totalCount)})}}).catch(function(t){a.$message.error("未删除，服务器错误"),console.log(t)})}).catch(function(){})},enterStock:function(){this.$router.push("/stock")},search:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return console.log("error submit!!"),!1;var a=""!==e.factory?e.factory:e.searchForm.templateFactory,r={templateId:e.searchForm.templateId,templateAreas:e.searchForm.templateAreas,templateFactory:a,templateStore:e.searchForm.templateStore};m.GetSearchStoreList.r(r,1).then(function(t){var r=t.data;e.$router.push("/store?id="+e.searchForm.templateId+"&areas="+e.searchForm.templateAreas+"&factory="+a+"&store="+e.searchForm.templateStore+"&currentPage=1"),e.currentPage=1,e.storeData=r.templateStockList,e.storeDataLength=parseInt(r.totalCount)})})},resetForm:function(t){this.$refs[t].resetFields()},formatterColumn:function(t,e){var a=t.templateStock.templateCtime;return console.log(a),a?c()(a).format("YYYY-MM-DD HH:mm:ss"):""},handleCurrentChange:function(t){var e=this;this.currentPage=parseInt(t);var a="factorier"===this.auth?this.factory:this.searchForm.templateFactory,r={templateId:this.searchForm.templateId,templateAreas:this.searchForm.templateAreas,templateFactory:a,templateStore:this.searchForm.templateStore};m.GetSearchStoreList.r(r,this.currentPage).then(function(t){var a=t.data;e.storeData=a.templateStockList,e.storeDataLength=parseInt(a.totalCount)}),this.$router.push("/store?id="+this.searchForm.templateId+"&areas="+this.searchForm.templateAreas+"&factory="+a+"&store="+this.searchForm.templateStore+"&currentPage="+t)},clickImg:function(t){this.showImg=!0,this.imgSrc=t.currentTarget.src},viewImg:function(){this.showImg=!1}}),computed:s()({},Object(h.c)(["factory","auth"])),created:function(){var t=this;this.token=n.b("token").token,this.currentPage=parseInt(this.$route.query.currentPage)||1;var e="factorier"===this.auth?this.factory:this.$route.query.factory;this.searchForm.templateId=this.$route.query.id||"",this.searchForm.templateAreas=this.$route.query.areas||"",this.searchForm.templateStore=this.$route.query.store||"";var a={templateId:this.searchForm.templateId,templateAreas:this.searchForm.templateAreas,templateFactory:e,templateStore:this.searchForm.templateStore},r=this.currentPage;m.GetSearchStoreList.r(a,r).then(function(e){var a=e.data;t.storeData=a.templateStockList,t.storeDataLength=a.totalCount,console.log(t.currentPage)}),this.$router.push("/store?id="+this.searchForm.templateId+"&areas="+this.searchForm.templateAreas+"&factory="+e+"&store="+this.searchForm.templateStore+"&currentPage="+this.currentPage),this.size=window.innerWidth<767?"mini":"medium",this.sizesmall=window.innerWidth<767},mounted:function(){if(window.innerWidth>=767){var t=this.$refs.tableWrapper.$el.clientHeight;this.tableHeight=t-50,console.log(this.tableHeight)}},components:{BigImg:l}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"store"},[a("el-card",{staticClass:"search-wrapper"},[a("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:t.searchForm,size:t.size,"label-width":"100px"}},[a("el-form-item",{staticClass:"search-form-item",attrs:{label:"样板编号",prop:"templateId"}},[a("el-input",{model:{value:t.searchForm.templateId,callback:function(e){t.$set(t.searchForm,"templateId",e)},expression:"searchForm.templateId"}})],1),t._v(" "),a("el-form-item",{staticClass:"search-form-item",attrs:{label:"样板产区",prop:"templateAreas"}},[a("el-input",{model:{value:t.searchForm.templateAreas,callback:function(e){t.$set(t.searchForm,"templateAreas",e)},expression:"searchForm.templateAreas"}})],1),t._v(" "),a("el-form-item",{staticClass:"search-form-item",attrs:{label:"样板分厂",prop:"templateFactory"}},[a("el-input",{attrs:{disabled:"factorier"===t.auth},model:{value:t.searchForm.templateFactory,callback:function(e){t.$set(t.searchForm,"templateFactory",e)},expression:"searchForm.templateFactory"}})],1),t._v(" "),a("el-form-item",{staticClass:"search-form-item",attrs:{label:"样板存储点",prop:"templateStore"}},[a("el-input",{model:{value:t.searchForm.templateStore,callback:function(e){t.$set(t.searchForm,"templateStore",e)},expression:"searchForm.templateStore"}})],1)],1),t._v(" "),a("div",{staticClass:"button-wrapper"},[a("el-button",{attrs:{size:t.size,type:"primary"},on:{click:function(e){t.search("searchForm")}}},[t._v("搜索")]),t._v(" "),a("el-button",{attrs:{size:t.size},on:{click:function(e){t.resetForm("searchForm")}}},[t._v("重置")]),t._v(" "),a("el-button",{directives:[{name:"has",rawName:"v-has",value:[t.api.Stock],expression:"[api.Stock]"}],attrs:{size:t.size,type:"primary"},on:{click:t.enterStock}},[t._v("库存新增")]),t._v(" "),a("a",{staticStyle:{"margin-left":"10px"},attrs:{href:"http://localhost:8080/templateStock/download?token="+t.token,target:"_blank"}},[a("el-button",{directives:[{name:"has",rawName:"v-has",value:[t.api.Stock],expression:"[api.Stock]"}],attrs:{size:t.size,type:"primary"}},[t._v("下载")])],1)],1)],1),t._v(" "),a("el-card",{ref:"tableWrapper",staticClass:"table-wrapper"},[a("el-table",{staticClass:"table-list",staticStyle:{width:"100%"},attrs:{size:t.size,data:t.storeData,height:t.tableHeight}},[a("el-table-column",{attrs:{prop:"templateStock.id",label:"库存编号",fixed:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateId",label:"样板编号"}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateAmount",label:"数量（片）"}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateSuits",label:"套数"}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateAreas",label:"产区"}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateFactory",label:"分厂"}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateStore",label:"存放点（货架编号）"}}),t._v(" "),a("el-table-column",{attrs:{label:"图片",width:"400"},scopedSlots:t._u([{key:"default",fn:function(e){return e.row.images?t._l(e.row.images,function(e){return a("img",{staticStyle:{"margin-right":"2px"},attrs:{src:"http://localhost:8080"+e.pictureUrl,alt:"",width:"70",height:"70"},on:{click:function(e){t.clickImg(e)}}})}):void 0}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateCtime",width:"100",label:"上传日期",formatter:t.formatterColumn}}),t._v(" "),a("el-table-column",{attrs:{prop:"templateStock.templateMemo",label:"备注"}}),t._v(" "),a("el-table-column",{attrs:{width:"150",label:"操作",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[!t.$_has([t.api.Stock])||"manager"!==t.auth&&t.factory!==e.row.templateStock.templateFactory?t._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(a){t.handleEdit(e.$index,e.row)}}},[t._v("操作")]),t._v(" "),!t.$_has([t.api.Stock])||"manager"!==t.auth&&t.factory!==e.row.templateStock.templateFactory?t._e():a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.handleDelete(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[5,10,25,50],"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.storeDataLength,small:t.sizesmall},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}})],1),t._v(" "),t.showImg?a("big-img",{attrs:{imgSrc:t.imgSrc},on:{clickit:t.viewImg}}):t._e()],1)},staticRenderFns:[]};var d=a("VU/8")(p,u,!1,function(t){a("BrUS")},"data-v-09aecaa7",null);e.default=d.exports},BrUS:function(t,e){},yjWW:function(t,e){}});
//# sourceMappingURL=2.ef47f5cb8e4ee738b253.js.map