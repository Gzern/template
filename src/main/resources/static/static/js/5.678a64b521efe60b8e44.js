webpackJsonp([5],{"7Tuw":function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t("Dd8w"),s=t.n(a),o=t("gyMJ"),l=t("PJh5"),i=t.n(l),c=(t("LOkV"),t("NYxO")),n={name:"Log",mixins:[{data:function(){return{api:o}}}],data:function(){return{size:"medium",sizesmall:!1,currentPage:1,pageSize:10,logData:[],logAmount:"",searchForm:{userName:"",userRole:"",factory:""}}},methods:{formatterColumn:function(e,r){var t=e[r.property];return void 0==t?"":i()(t).format("YYYY-MM-DD HH:mm:ss")},search:function(e){var r=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;var t=""!==r.factory?r.factory:r.searchForm.templateFactory,a={userName:r.searchForm.userName,userRole:r.searchForm.userRole,factory:t};o.GetOrderList.r(a,1).then(function(e){var a=e.data;r.$router.push("/log?userName="+r.searchForm.userName+"&userRole="+r.searchForm.userRole+"&factory="+t+"&currentPage=1"),r.currentPage=1,r.logData=a.data.orderList,r.logAmount=parseInt(a.data.total)})})},resetForm:function(e){this.$refs[e].resetFields()},handleCurrentChange:function(e){var r=this;this.currentPage=parseInt(e);var t="factorier"===this.auth?this.factory:this.searchForm.templateFactory,a={userName:this.searchForm.userName,userRole:this.searchForm.userRole,factory:t};o.GetOrderList.r(a,this.currentPage).then(function(e){var t=e.data;r.logData=t.data.orderList,r.logAmount=parseInt(t.data.total)}),this.$router.push("/log?userName="+this.searchForm.userName+"&userRole="+this.searchForm.userRole+"&factory="+t+"&currentPage="+e)}},computed:s()({},Object(c.c)(["factory","auth"])),created:function(){var e=this;this.size=window.innerWidth<767?"mini":"medium",this.sizesmall=window.innerWidth<767,this.currentPage=parseInt(this.$route.query.currentPage)||1;var r="factorier"===this.auth?this.factory:this.$route.query.factory;this.searchForm.userName=this.$route.query.userName||"",this.searchForm.userRole=this.$route.query.userRole||"",console.log(r);var t={userName:this.searchForm.userName,userRole:this.searchForm.userRole,factory:r};this.currentPage;o.GetOrderList.r(t,this.currentPage).then(function(r){var t=r.data;"SUCCESS"===t.success&&(e.logData=t.data.orderList,e.logAmount=parseInt(t.data.total))}),this.$router.push("/log?userName="+this.searchForm.userName+"&userRole="+this.searchForm.userRole+"&factory="+r+"&currentPage=1")},mounted:function(){if(window.innerWidth>=767){var e=this.$refs.tableWrapper.$el.clientHeight;this.tableHeight=e-50,console.log(this.tableHeight)}}},u={render:function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"log"},[t("el-card",{staticClass:"search-wrapper"},[t("el-form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,size:e.size,"label-width":"100px"}},[t("el-form-item",{staticClass:"search-form-item",attrs:{label:"用户名",prop:"userName"}},[t("el-input",{model:{value:e.searchForm.userName,callback:function(r){e.$set(e.searchForm,"userName",r)},expression:"searchForm.userName"}})],1),e._v(" "),t("el-form-item",{staticClass:"search-form-item",attrs:{label:"用户角色",prop:"userRole"}},[t("el-input",{model:{value:e.searchForm.userRole,callback:function(r){e.$set(e.searchForm,"userRole",r)},expression:"searchForm.userRole"}})],1),e._v(" "),t("el-form-item",{staticClass:"search-form-item",attrs:{label:"分厂",prop:"factory"}},[t("el-input",{attrs:{disabled:"factorier"===e.auth},model:{value:e.searchForm.factory,callback:function(r){e.$set(e.searchForm,"factory",r)},expression:"searchForm.factory"}})],1)],1),e._v(" "),t("div",{staticClass:"button-wrapper"},[t("el-button",{attrs:{size:e.size,type:"primary"},on:{click:function(r){e.search("searchForm")}}},[e._v("搜索")]),e._v(" "),t("el-button",{attrs:{size:e.size},on:{click:function(r){e.resetForm("searchForm")}}},[e._v("重置")])],1)],1),e._v(" "),t("el-card",{ref:"tableWrapper",staticClass:"table-wrapper"},[t("el-table",{staticClass:"table-list",staticStyle:{width:"100%"},attrs:{size:e.size,data:e.logData,height:e.tableHeight,border:""}},[t("el-table-column",{attrs:{prop:"opUserId",label:"用户id","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opName",label:"用户名","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opRole",width:"100",label:"用户角色","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opFactory",label:"分厂","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opBehavier",width:"140",label:"操作信息","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opAmount",label:"数量","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opAddress",label:"外借地点","header-align":"center"}}),e._v(" "),t("el-table-column",{attrs:{prop:"opTime",width:"100",label:"操作时间","header-align":"center",formatter:e.formatterColumn}})],1),e._v(" "),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next",total:e.logAmount,small:e.sizesmall},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(r){e.currentPage=r}}})],1)],1)},staticRenderFns:[]};var h=t("VU/8")(n,u,!1,function(e){t("R6Hc")},"data-v-fba39f42",null);r.default=h.exports},R6Hc:function(e,r){}});
//# sourceMappingURL=5.678a64b521efe60b8e44.js.map