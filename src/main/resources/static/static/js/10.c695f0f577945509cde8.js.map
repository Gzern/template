{"version":3,"sources":["webpack:///src/components/Config/Config.vue","webpack:///./src/components/Config/Config.vue?3382","webpack:///./src/components/Config/Config.vue"],"names":["Config","name","data","_this","this","isNotFactory","ruleForm","username","userId","role","factory","rules","validator","rule","value","callback","Error","trigger","roleList","methods","submitForm","formName","_this2","$refs","validate","valid","console","log","obj","userInfo","id","userFactory","roleId","t","stringify_default","manager","r","then","_ref","success","$message","$router","push","$route","query","currentPage","search","error","catch","err","resetForm","resetFields","back","roleChange","val","i","length","roleFactory","computed","extends_default","Object","vuex_esm","created","_this3","size","window","innerWidth","assign_default","currentConfig","_ref2","_ref3","userName","roleInfos","Config_Config","render","_vm","_h","$createElement","_c","_self","staticClass","attrs","slot","_v","staticStyle","float","type","on","click","ref","model","label-width","label","prop","disabled","$$v","$set","expression","width","change","_l","key","index","roleName","$event","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"iMAiCAA,GACAC,KAAA,GACAC,KAFA,WAEA,IAAAC,EAAAC,KAcA,OACAC,aAAA,GACAC,UACAC,SAAA,GACAC,OAAA,GACAC,KAAA,GACAC,QAAA,IAEAC,OACAD,UACAE,UAvBA,SAAAC,EAAAC,EAAAC,GACAZ,EAAAE,aASAU,IARA,KAAAD,EACAC,EAAA,IAAAC,MAAA,2BAGAD,KAiBAE,QAAA,UAGAC,cAGAC,SACAC,WADA,SACAC,GAAA,IAAAC,EAAAlB,KACAA,KAAAmB,MAAAF,GAAAG,SAAA,SAAAC,GACA,IAAAA,EAwBA,OADAC,QAAAC,IAAA,mBACA,EAvBA,IAAAC,GACAC,UACAC,GAAAR,EAAAhB,SAAAE,OACAuB,YAAAT,EAAAhB,SAAAI,SAEAsB,OAAAV,EAAAhB,SAAAG,MAEAwB,EAAAC,IAAAN,GACAO,EAAA,eAAAC,EAAAH,GAAAI,KAAA,SAAAC,GACA,YADAA,EAAApC,KACAqC,SACAjB,EAAAkB,SAAAD,QAAA,QACAjB,EAAAmB,QAAAC,KAAA,wBAAApB,EAAAqB,OAAAC,MAAAC,YAAA,WAAAvB,EAAAqB,OAAAC,MAAAE,SAGAxB,EAAAkB,SAAAO,MAAA,WAGAC,MAAA,SAAAC,GACAvB,QAAAC,IAAAsB,GACA3B,EAAAkB,SAAAO,MAAA,cAQAG,UA/BA,SA+BA7B,GACAjB,KAAAmB,MAAAF,GAAA8B,eAEAC,KAlCA,WAmCAhD,KAAAqC,QAAAC,KAAA,wBAAAtC,KAAAuC,OAAAC,MAAAC,YAAA,WAAAzC,KAAAuC,OAAAC,MAAAE,SAEAO,WArCA,SAqCAC,GACA,QAAAC,EAAA,EAAAA,EAAAnD,KAAAc,SAAAsC,OAAAD,IACAnD,KAAAc,SAAAqC,GAAAzB,KAAAwB,IACAlD,KAAAc,SAAAqC,GAAAE,YACArD,KAAAC,cAAA,GAGAD,KAAAC,cAAA,EACAD,KAAAE,SAAAI,QAAA,OAMAgD,SAAAC,OACAC,OAAAC,EAAA,EAAAD,EAAA,mBAGAE,QAvFA,WAuFA,IAAAC,EAAA3D,KACAA,KAAA4D,KAAAC,OAAAC,WAAA,oBAEA9D,KAAAE,SAAA6D,OAAA/D,KAAAgE,eAEA1C,QAAAC,IAAAvB,KAAAuC,OAAAC,MAAApC,QACA2B,EAAA,YAAAC,IAAAC,KAAA,SAAAgC,GAAA,IAAAnE,EAAAmE,EAAAnE,KACA,YAAAA,EAAAqC,UACAwB,EAAA7C,SAAAhB,UAEA8C,MAAA,SAAAC,GACAvB,QAAAC,IAAAsB,GACAc,EAAAvB,SAAAO,MAAA,cAEAZ,EAAA,YAAAC,EAAAhC,KAAAuC,OAAAC,MAAApC,QAAA6B,KAAA,SAAAiC,GAAA,IAAApE,EAAAoE,EAAApE,KACA6D,EAAAzD,SAAAC,SAAAL,OAAA2B,SAAA0C,SACAR,EAAAzD,SAAAE,OAAAN,OAAA2B,SAAAC,GACAiC,EAAAzD,SAAAG,KAAAP,OAAAsE,UAAA,GAAA1C,GACA5B,OAAAsE,UAAA,GAAAf,aACAM,EAAA1D,cAAA,EAEA0D,EAAAzD,SAAAI,QAAAR,OAAA2B,SAAAE,cAGAgC,EAAA1D,cAAA,EACA0D,EAAAzD,SAAAI,QAAA,MAEAsC,MAAA,SAAAC,GACAvB,QAAAC,IAAAsB,GACAc,EAAAvB,SAAAO,MAAA,gBClJA0B,GADiBC,OAFjB,WAA0B,IAAAC,EAAAvE,KAAawE,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,WAAqBF,EAAA,WAAgBE,YAAA,mBAA6BF,EAAA,OAAYE,YAAA,WAAAC,OAA8BC,KAAA,UAAgBA,KAAA,WAAeJ,EAAA,QAAaE,YAAA,SAAmBL,EAAAQ,GAAA,YAAAR,EAAAQ,GAAA,KAAAL,EAAA,aAAiDE,YAAA,OAAAI,aAAgCC,MAAA,SAAgBJ,OAAQK,KAAA,UAAgBC,IAAKC,MAAAb,EAAAvB,QAAkBuB,EAAAQ,GAAA,YAAAR,EAAAQ,GAAA,KAAAL,EAAA,WAA+CW,IAAA,WAAAT,YAAA,YAAAC,OAA8CS,MAAAf,EAAArE,SAAA0D,KAAAW,EAAAX,KAAArD,MAAAgE,EAAAhE,MAAAgF,cAAA,WAA8Eb,EAAA,gBAAqBG,OAAOW,MAAA,MAAAC,KAAA,cAAiCf,EAAA,YAAiBG,OAAOa,UAAA,GAAgBJ,OAAQ5E,MAAA6D,EAAArE,SAAA,SAAAS,SAAA,SAAAgF,GAAuDpB,EAAAqB,KAAArB,EAAArE,SAAA,WAAAyF,IAAwCE,WAAA,wBAAiC,GAAAtB,EAAAQ,GAAA,KAAAL,EAAA,gBAAqCG,OAAOW,MAAA,OAAAC,KAAA,YAAgCf,EAAA,YAAiBG,OAAOa,UAAA,GAAgBJ,OAAQ5E,MAAA6D,EAAArE,SAAA,OAAAS,SAAA,SAAAgF,GAAqDpB,EAAAqB,KAAArB,EAAArE,SAAA,SAAAyF,IAAsCE,WAAA,sBAA+B,GAAAtB,EAAAQ,GAAA,KAAAL,EAAA,gBAAqCG,OAAOW,MAAA,OAAAC,KAAA,UAA8Bf,EAAA,aAAkBM,aAAac,MAAA,QAAeX,IAAKY,OAAAxB,EAAAtB,YAAwBqC,OAAQ5E,MAAA6D,EAAArE,SAAA,KAAAS,SAAA,SAAAgF,GAAmDpB,EAAAqB,KAAArB,EAAArE,SAAA,OAAAyF,IAAoCE,WAAA,kBAA6BtB,EAAAyB,GAAAzB,EAAA,kBAAAlE,GAAsC,OAAAqE,EAAA,aAAuBuB,IAAA5F,EAAA6F,MAAArB,OAAsBW,MAAAnF,EAAA8F,SAAAzF,MAAAL,EAAAqB,UAAyC,GAAA6C,EAAAQ,GAAA,KAAAL,EAAA,gBAAsCG,OAAOW,MAAA,OAAAC,KAAA,aAAiCf,EAAA,YAAiBG,OAAOa,SAAAnB,EAAAtE,cAA4BqF,OAAQ5E,MAAA6D,EAAArE,SAAA,QAAAS,SAAA,SAAAgF,GAAsDpB,EAAAqB,KAAArB,EAAArE,SAAA,UAAAyF,IAAuCE,WAAA,uBAAgC,OAAAtB,EAAAQ,GAAA,KAAAL,EAAA,aAAsCG,OAAOK,KAAA,WAAiBC,IAAKC,MAAA,SAAAgB,GAAyB7B,EAAAvD,WAAA,gBAA6BuD,EAAAQ,GAAA,QAAAR,EAAAQ,GAAA,KAAAL,EAAA,aAA6CS,IAAIC,MAAA,SAAAgB,GAAyB7B,EAAAzB,UAAA,gBAA4ByB,EAAAQ,GAAA,iBAEr5DsB,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACA5G,EACAyE,GATA,EAVA,SAAAoC,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/10.c695f0f577945509cde8.js","sourcesContent":["<template>\n\t<div class=\"config\">\n    <el-card class=\"config-wrapper\">\n      <div slot=\"header\" class=\"clearfix\">\n        <span class=\"text\">用户角色配置</span>\n        <el-button style=\"float:right;\" class=\"back\" type=\"danger\" @click=\"back\">返回</el-button>\n      </div>\n      \n      <el-form :model=\"ruleForm\" :size=\"size\" :rules=\"rules\" ref=\"ruleForm\" class=\"rule-form\" label-width=\"100px\">\n        <el-form-item label=\"用户名\" prop=\"username\">\n          <el-input v-model=\"ruleForm.username\" :disabled=\"true\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"用户id\" prop=\"userId\">\n          <el-input v-model=\"ruleForm.userId\" :disabled=\"true\"></el-input>\n        </el-form-item>\n        <el-form-item label=\"用户角色\" prop=\"role\">\n          <el-select v-model=\"ruleForm.role\" style=\"width: 100%;\" @change=\"roleChange\">\n            <el-option v-for=\"role in roleList\" :label=\"role.roleName\" :value=\"role.id\" :key=\"role.index\"></el-option>\n          </el-select>\n        </el-form-item>\n        <el-form-item label=\"用户分厂\" prop=\"factory\">\n          <el-input v-model=\"ruleForm.factory\" :disabled=\"isNotFactory\"></el-input>\n        </el-form-item>\n      </el-form>\n      <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">提交</el-button>\n      <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\n    </el-card>\n  </div>\n</template>\n\n<script>\n  import { mapGetters, mapMutations } from 'vuex'\n  import * as api from 'api/manager'\n  export default {\n    name: \"\",\n    data() {\n      var factoryValidator = (rule, value, callback) => {\n        if (!this.isNotFactory) {\n          if (value === '') {\n            callback(new Error('This field is required'))\n          }\n          else {\n            callback()\n          }\n        }\n        else {\n          callback()\n        }\n      }\n      return {\n        isNotFactory: \"\",\n        ruleForm: {\n          username: '',\n          userId: '',\n          role: '',\n          factory: ''\n        },\n        rules: {\n          factory: [\n            { validator: factoryValidator, trigger: 'blur' }\n          ]\n        },\n        roleList: []\n      }\n    },\n    methods: {\n      submitForm(formName) {\n        this.$refs[formName].validate((valid) => {\n          if (valid) {\n            let obj = {\n              userInfo: {\n                id: this.ruleForm.userId,\n                userFactory: this.ruleForm.factory\n              },\n              roleId: this.ruleForm.role\n            }\n            var t = JSON.stringify(obj)\n            api.ConfigUserRole.r(t).then(({ data }) => {\n              if (data.success === 'SUCCESS') {\n                this.$message.success('修改成功')\n                this.$router.push(`/manager?currentPage=${this.$route.query.currentPage}&search=${this.$route.query.search}`)\n              }\n              else {\n                this.$message.error('未修改成功')\n              }\n              \n            }).catch(err => {\n              console.log(err)\n              this.$message.error('服务器错误')\n            })\n          } else {\n            console.log('error submit!!')\n            return false\n          }\n        })\n      },\n      resetForm(formName) {\n        this.$refs[formName].resetFields()\n      },\n      back() {\n        this.$router.push(`/manager?currentPage=${this.$route.query.currentPage}&search=${this.$route.query.search}`)\n      },\n      roleChange(val) {\n        for (let i = 0; i < this.roleList.length; i++) {\n          if (this.roleList[i].id === val) {\n            if (this.roleList[i].roleFactory) {\n              this.isNotFactory = false\n            }\n            else {\n              this.isNotFactory = true\n              this.ruleForm.factory = ''\n            }\n          }\n        }\n      }\n    },\n    computed: {\n      ...mapGetters([ 'currentConfig' ]),\n    },\n    \n    created() {\n      this.size = (window.innerWidth < 767) ? 'mini' : 'medium'\n      // 这里就不用取数据了\n      this.ruleForm = Object.assign({}, this.currentConfig)\n      // 用api取数据，防止刷新数据没有\n      console.log(this.$route.query.userId)\n      api.GetRoleList.r().then(({ data }) => {\n        if (data.success === 'SUCCESS') {\n          this.roleList = data.data\n        }\n      }).catch(err => {\n        console.log(err)\n        this.$message.error('加载失败，请刷新')\n      })\n      api.GetUserInfo.r(this.$route.query.userId).then(({ data }) => {\n        this.ruleForm.username = data.data.userInfo.userName\n        this.ruleForm.userId = data.data.userInfo.id\n        this.ruleForm.role = data.data.roleInfos[0].id\n        if (data.data.roleInfos[0].roleFactory) {\n          this.isNotFactory = false\n          // 这边测一下option的值\n          this.ruleForm.factory = data.data.userInfo.userFactory\n        }\n        else {\n          this.isNotFactory = true\n          this.ruleForm.factory = ''\n        }\n      }).catch(err => {\n        console.log(err)\n        this.$message.error('加载失败，请刷新')\n      })\n    }\n  }\n</script>\n\n<style type=\"text/stylus\" lang=\"stylus\" rel=\"stylesheet/stylus\" scoped>\n  @import \"~assets/stylus/variable.styl\"\n  @import \"Config.styl\"\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/Config/Config.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"config\"},[_c('el-card',{staticClass:\"config-wrapper\"},[_c('div',{staticClass:\"clearfix\",attrs:{\"slot\":\"header\"},slot:\"header\"},[_c('span',{staticClass:\"text\"},[_vm._v(\"用户角色配置\")]),_vm._v(\" \"),_c('el-button',{staticClass:\"back\",staticStyle:{\"float\":\"right\"},attrs:{\"type\":\"danger\"},on:{\"click\":_vm.back}},[_vm._v(\"返回\")])],1),_vm._v(\" \"),_c('el-form',{ref:\"ruleForm\",staticClass:\"rule-form\",attrs:{\"model\":_vm.ruleForm,\"size\":_vm.size,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\",\"prop\":\"username\"}},[_c('el-input',{attrs:{\"disabled\":true},model:{value:(_vm.ruleForm.username),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"username\", $$v)},expression:\"ruleForm.username\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"用户id\",\"prop\":\"userId\"}},[_c('el-input',{attrs:{\"disabled\":true},model:{value:(_vm.ruleForm.userId),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"userId\", $$v)},expression:\"ruleForm.userId\"}})],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"用户角色\",\"prop\":\"role\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},on:{\"change\":_vm.roleChange},model:{value:(_vm.ruleForm.role),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"role\", $$v)},expression:\"ruleForm.role\"}},_vm._l((_vm.roleList),function(role){return _c('el-option',{key:role.index,attrs:{\"label\":role.roleName,\"value\":role.id}})}))],1),_vm._v(\" \"),_c('el-form-item',{attrs:{\"label\":\"用户分厂\",\"prop\":\"factory\"}},[_c('el-input',{attrs:{\"disabled\":_vm.isNotFactory},model:{value:(_vm.ruleForm.factory),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"factory\", $$v)},expression:\"ruleForm.factory\"}})],1)],1),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.submitForm('ruleForm')}}},[_vm._v(\"提交\")]),_vm._v(\" \"),_c('el-button',{on:{\"click\":function($event){_vm.resetForm('ruleForm')}}},[_vm._v(\"重置\")])],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-2830f758\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/Config/Config.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-2830f758\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!stylus-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Config.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Config.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Config.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-2830f758\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Config.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-2830f758\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Config/Config.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}